<!doctype html>
<html lang="en" class="has-spaced-navbar-fixed-top">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
<title>Mapping Over Assertion Subjects</title>

<!-- CSS  -->
<link href="/css/bulma.min.css" type="text/css"
      rel="stylesheet" media="screen,projection">

<meta name="description" content="">
<meta name="author" content="">
<meta name="keywords" content="">
<meta name="generator" content="JBake v2.6.1">

<script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js"
        integrity="sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe"
        crossorigin="anonymous"></script>
</head>
<body>
<nav class="navbar is-spaced is-fixed-top is-black" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src="/img/logo-white-28.png" alt="Strikt">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-menu" id="navMenu">
      <div class="navbar-start">
      </div>

      <div class="navbar-end">
        <a class="navbar-item" href="/"><span class="icon has-text-info"><i
          class="fas fa-home"></i></span><span>Home</span></a>
        <a class="navbar-item" href="/about.html"><span class="icon has-text-info"><i
          class="fas fa-info-circle"></i></span><span>About</span></a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link"><span class="icon has-text-info"><i
            class="fas fa-book"></i></span><span>User guide</span></a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="/user-guide/getting-started.html">Getting started</a>
            <a class="navbar-item" href="/user-guide/assertion-styles.html">Assertion styles</a>
            <a class="navbar-item" href="/user-guide/common-patterns.html">Common Assertion Patterns</a>
            <a class="navbar-item" href="/user-guide/flow-typing.html">Strongly Typed Assertions</a>
            <a class="navbar-item" href="/user-guide/mapping.html">Mapping Over Assertion Subjects</a>
            <a class="navbar-item" href="/user-guide/custom-assertions.html">Custom assertions</a>
          </div>
        </div>
        <a class="navbar-item" href="/api/strikt-core"><span class="icon has-text-info"><i class="fas fa-file-alt"></i></span><span>API</span></a>
      </div>
    </div>
  </div>
</nav>
<main class="section">
  <div class="container">
    <div class="content is-medium"><h1>Mapping Over Assertion Subjects</h1> 
<p>Although you can obviously write assertions for the properties of an object with code like this:</p> 
<pre><code class="language-kotlin">expect(map.size).isEqualTo(1)
expect(list.first()).isEqualTo("fnord")
expect(person.name).isEqualTo("Ziggy")
</code></pre> 
<p>Sometimes it's useful to be able to transform an assertion on a subject to an assertion on a property of that subject, or the result of a method call.<br> Strikt allows for this using the <code>Assertion&lt;T&gt;.map</code> method.</p> 
<h2>Mapping with lambdas</h2> 
<p>The method takes a lambda whose receiver is the current subject and returns an <code>Assertion&lt;R&gt;</code> where <code>R</code> is whatever the lambda returns.</p> 
<p>This is sometimes useful for making assertions about the properties of an object or the values returned by methods, particularly if you want to use a block-style assertion to validate multiple object properties.</p> 
<pre><code class="language-kotlin">val subject = Person(name = "David", birthDate = LocalDate.of(1947, 1, 8))
expect(subject) {
  map { name }.isEqualTo("David")
  map { birthDate }.map { year }.isEqualTo(1947)
}
</code></pre> 
<h2>Mapping with property or method references</h2> 
<p>If you use a Kotlin property or Java method reference as the lambda passed to <code>map</code>, Strikt will automatically derive the property name and use it as the subject description on the returned assertion.<br> This is useful for generating good quality assertion output with minimal effort.</p> 
<p>For example, if the previous example fails it will format the error message like this:</p> 
<pre><code>Person[name: Ziggy, birthDate: 1972-06-16] (2 failures) 
    Expect that "Ziggy" (1 failure)
        is equal to "David" : found "Ziggy"
    Expect that 1972-06-16 (1 failure) 
        Expect that 1972 (1 failure)
            is equal to 1947 : found 1972
</code></pre> 
<p>Using property references the output is more useful.</p> 
<pre><code class="language-kotlin">val subject = Person(name = "David", birthDate = LocalDate.of(1947, 1, 8))
expect(subject) {
  map(Person::name).isEqualTo("David")
  map(Person::birthDate).map(LocalDate::getYear).isEqualTo(1947)
}
</code></pre> 
<pre><code>Person[name: Ziggy, birthDate: 1972-06-16] (2 failures) 
    .name "Ziggy" (1 failure)
        is equal to "David" : found "Ziggy"
    .birthDate 1972-06-16 (1 failure) 
        .year 1972 (1 failure)
            is equal to 1947 : found 1972
</code></pre> 
<h2>Creating re-usable mappings with extensions</h2> 
<p>If you find yourself frequently using <code>map</code> for the same properties or methods, you should consider defining extension property or method to make things even easier.<br> Strikt makes this easy.</p> 
<p>For example:</p> 
<pre><code class="language-kotlin">val Assertion&lt;Person&gt;.name: Assertion&lt;String&gt;
  get() = map(Person::name)

val Assertion&lt;Person&gt;.yearOfBirth: Assertion&lt;LocalDate&gt;
  get() = map { dateOfBirth.year }
</code></pre> 
<p>You can then write the earlier example as:</p> 
<pre><code class="language-kotlin">val subject = Person(name = "David", birthDate = LocalDate.of(1947, 1, 8))
expect(subject) {
  name.isEqualTo("David")
  yearOfBirth.isEqualTo(1947)
}
</code></pre> 
<h2>Built-in mappings</h2> 
<p>Strikt has a number of built in mapping properties and functions such as <code>Assertion&lt;List&lt;E&gt;&gt;.first()</code> which returns an <code>Assertion&lt;E&gt;</code> whose subject is the first element of the list.</p></div>
  <nav class="pagination is-medium" role="navigation" aria-label="pagination">
    <a class="pagination-previous button is-large is-link is-outlined"
       href="flow-typing.html" >
      <span class="icon">
        <i class="fas fa-arrow-left"></i>
      </span>
    </a>
    <a class="pagination-next button is-large is-link is-outlined" href="custom-assertions.html"
       >
      <span class="icon">
        <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  </nav>
  </div>
</main>
<footer class="footer">
  <div class="container">
    <div class="columns">
      <div class="column">
        <p class="has-text-left-tablet has-text-centered-mobile">
          <a href="https://github.com/robfletcher/strikt/" class="button is-dark">
            <span class="icon"><i class="fab fa-lg fa-github"></i></span><span>GitHub</span>
          </a>
          <a href="https://kotlinlang.slack.com/messages/CAR7KJ96J" class="button is-danger">
            <span class="icon"><i class="fab fa-lg fa-slack-hash"></i></span><span>Slack</span>
          </a>
          <a href="https://twitter.com/stri_kt" class="button is-info">
            <span class="icon"><i class="fab fa-lg fa-twitter"></i></span><span>Twitter</span>
          </a>
        </p>
      </div>
      <div class="column">
        <p class="has-text-right-tablet has-text-centered-mobile">
          <a href="https://bulma.io/">
            <img src="/img/made-with-bulma--semiblack.png" alt="Bulma" width="171" height="32">
          </a>
          <a href="https://jbake.org">
            <img src="/img/jbake_128x128.png" alt="JBake v2.6.1" width="32" height="32">
          </a>
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="/js/init.js"></script>
</body>
</html>
